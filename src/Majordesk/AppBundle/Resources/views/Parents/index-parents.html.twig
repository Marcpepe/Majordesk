{% extends "::layout.html.twig" %}

{% block title %}
	Accueil - {{ parent() }}
{% endblock %}

{% block body %}
<span class="visible-md"><br><br></span>
<span class="visible-lg"><br><br></span>

<div id="select-enfant" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
		  <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
			<h3 id="myModalLabel">Sélectionner un enfant</h3>
		  </div>
		  <div class="modal-body">
			<p>
			{% for eleve in eleves %}
				<a href="{{ path('majordesk_app_suivi_enfant', {'id_eleve' : eleve.id }) }}" class="btn btn-default">{{ eleve.username }}</a> 
			{% else %}
				Aucun enfant inscrit.
			{% endfor %}
			</p>
		  </div>
		</div>
	</div>
</div>

<div class="col-lg-4">
	{% if famille.hasSuivi %}
		<a class="btn btn-info-inverted btn-block" data-toggle="modal" data-target="#select-enfant">{% if eleves|length > 1 %}<i class="icon-group icon-4x"></i>{% else %}<i class="icon-user icon-4x"></i>{% endif %} <span class="position-relative-up-12">Suivi de {% if eleves|length > 1 %}vos enfants{% else %}votre enfant{% endif %}</span></a>			
	{% else %}
		<a rel="tooltip" data-title="Cet accès est désactivé" class="btn btn-info-inverted btn-block inactif">{% if eleves|length > 1 %}<i class="icon-group icon-4x"></i>{% else %}<i class="icon-user icon-4x"></i>{% endif %} <span class="position-relative-up-12">Suivi de {% if eleves|length > 1 %}vos enfants{% else %}votre enfant{% endif %}</span></a>			
	{% endif %}
</div>
<div class="col-lg-4">
	<a class="btn btn-purple-inverted btn-block" href="{{ path('majordesk_app_calendrier_famille') }}"><i class="icon-calendar icon-4x"></i> <span class="position-relative-up-12">Calendrier des cours {% if cal_events_proches|length > 0 %}<span rel="tooltip" data-title="{{ cal_events_proches|length }} cours programmé(s)" class="badge">{{ cal_events_proches|length }}</span>{% endif %}</span></a>			
</div>
<div class="col-lg-4">
	<a class="btn btn-success-inverted btn-block" href="{{ path('majordesk_app_abonnements_factures') }}"><i class="icon-money icon-4x"></i> <span class="position-relative-up-12">Paiements et factures</span></a>
</div>
<div class="clearfix"></div>
<br><br>
<div class="col-lg-12">
	<div class="panel panel-default">
		<div class="panel-body">
			<div class="col-lg-6">
				<h4>Prochain(s) cours :</h4>
				<ul>{% set mois = {1:'Janvier',2:'Février',3:'Mars',4:'Avril',5:'Mai',6:'Juin',7:'Juillet',8:'Août',9:'Septembre',10:'Octobre',11:'Novembre',12:'Décembre'} %}
					{% set jour = {1:'Lundi',2:'Mardi',3:'Mercredi',4:'Jeudi',5:'Vendredi',6:'Samedi',7:'Dimanche'} %}
					{% for cal_event in cal_events_proches %}
						<li>{{ jour[cal_event.dateCours|date('N')] ~ ' ' ~ cal_event.dateCours|date('j') ~ ' ' ~ mois[cal_event.dateCours|date('n')] }} ({{ cal_event.heureDebut}}-{{ cal_event.heureFin}}) </li>
					{% else %}
						<li><a href="{{ path('majordesk_app_calendrier_famille') }}">Programmer un cours</a></li>
					{% endfor %}
				</ul>
			</div>
			<div class="col-lg-6">
				<h4> Parrainage <span class="text-pomegranate">(Bientôt disponible)</span></h4>
				Satisfait de votre professeur et de nos services ? Pour chaque famille que vous parrainez, vous recevez <strong>1 heure de cours gratuite</strong> !
				<br><br>
				<ul><li><a class="cursor-forbidden">Parrainer une famille</a></li></ul>
			</div>
			<div class="clearfix"></div><br>
			<div class="col-lg-6">
				<h4> Votre crédit d'heures de cours est de : <span class="{% if famille.heuresRestantes >= 10 %}text-emerald{% elseif famille.heuresRestantes <= 9 and famille.heuresRestantes > 2 %}text-orange{% else %}text-pomegranate{% endif %}">{{ famille.heuresRestantes / 10 }}</span></h4>
				<ul><li><a href="{{ path('majordesk_app_achat_heures') }}">Recharger votre compte</a></li></ul>
			</div>
			<div class="col-lg-6">
				<h4> Contact : </h4>
				Si vous avez la moindre question ou le moindre problème, n'hésitez pas à nous contacter :
				<ul>
					<li>par téléphone au 06.63.15.24.17</li>
					<li>par mail à l'adresse contact@majorclass.fr</li>
				</ul>
			</div>
			<div class="clearfix"></div><br>
			<div class="col-lg-12">
				<h4> Activité récente : </h4>
				{% if paiements|length > 0 %}
				<div class="table-responsive">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>Date du paiement</th>
								<th>Description</th>
								<th>Montant</th>
								<th>Statut</th>
							</tr>
						</thead>
						<tbody>
						{% for paiement in paiements %}
							<tr>
								<td>{{ paiement.datePaiement|date('d/m/Y') }}</td>
								<td>
									{{ paiement.description|raw }}
								</td>
								<td>
									{% if paiement.pack >= 100 and paiement.pack < 200 %}
										<em>Décompte
										{% if paiement.pack == 110 %}
											1h
										{% elseif paiement.pack == 115 %}
											1h30
										{% elseif paiement.pack == 120 %}
											2h 
										{% elseif paiement.pack == 125 %}
											2h30 
										{% elseif paiement.pack == 130 %}
											3h
										{% elseif paiement.pack == 140 %}
											4h 
										{% elseif paiement.pack == 150 %}
											5h
										{% elseif paiement.pack == 195 %} <!--spécial Carazo : à supprimer plus tard -->
											19.5h
										{% endif %}
										</em>
									{% else %}
										{{ (paiement.montant / 100)|number_format(2, ',', ' ') }} €
									{% endif %}
								</td>
								<td>
									{% if paiement.transaction == 0 %}
										<i rel="tooltip" data-title="Paiement annulé" class="icon-remove text-red cursor-help"></i>
									{% elseif paiement.transaction == 1 %}
										<i rel="tooltip" data-title="Paiement en cours" class="icon-spin icon-spinner text-orange cursor-help"></i>
									{% elseif paiement.transaction == 2 %}
										<i rel="tooltip" data-title="Paiement validé" class="icon-ok text-green cursor-help"></i>
									{% elseif paiement.transaction == 3 %}
										<i rel="tooltip" data-title="Paiement non validé" class="icon-exclamation-sign text-red cursor-help"></i>
									{% else %}
										<i rel="tooltip" data-title="Paiement validé" class="icon-ok text-green cursor-help"></i>
									{% endif %}
								</td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
				</div>
				{% else %}
					Aucune activité récente.
				{% endif %}
			</div>
			<div class="clearfix"></div><br>
		</div>
	</div>
</div>



{% endblock %}

{% block javascripts %}
	{{ parent() }}
{% endblock %}